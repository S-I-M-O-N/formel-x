' Gambas class file

' Formel-X, a Round counter for slotcar-roads about a light barrier.
' ----------------------------------------------------------------------------
' FHilfe IS part OF Formel-X.
'
' Copyright (C) 2011, 2012 Hermann Friedhoff <foto-schubser@arcor.de>
'
' Formel-X IS free software: you can redistribute it AND / OR modify
' it under the terms OF the GNU General PUBLIC License AS published by
' the Free Software Foundation, either version 3 OF the License, OR
' (at your option) any later version.
'
' Formel-X IS distributed IN the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty OF
' MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.See the
' GNU General PUBLIC License FOR more details.
'
' You should have received a COPY OF the GNU General PUBLIC License
' along WITH Formel-X. If NOT, see <http://www.gnu.org/licenses/>.
' ----------------------------------------------------------------------------

PUBLIC sInitPfad AS String = User.Home & "/." & Application.Name          ' Pfad & Name vom versteckten Ordner im Benutzer-Ordner
PUBLIC sBilderOrdner AS String = "/images"                                ' Ordner der Bilder

PUBLIC SUB _new()
  DIM sDatei AS String                                                    ' Pfad & Name
  DIM sDatenPfad AS String                                                ' Pfad für die Programm-Dateien
  sDatenPfad = File.Load(sInitPfad & "/Datenpfad.init")                   ' Dateienpfad laden
  sDatei = sDatenPfad & sBilderOrdner & "/r-z.png"                        ' Pfad und Name vom Programm-Icon
  IF Exist(sDatei) THEN FHilfe.Icon = Picture[sDatei]                     ' Programm-Icon laden und anzeigen
  sDatei = sDatenPfad & "/README"                                         ' Pfad und Name vom README-Text
  IF Exist(sDatei) THEN txaHilfe.Text = File.Load(sDatei)                 ' README-Text laden und anzeigen
  FHilfe.Text = "Hilfe - " & Application.Name                             ' Dialogname um Programmnamen erweitern
CATCH                                                                     ' Fehler abfangen
  Message.Error(Error.Text)                                               ' Fehler anzeigen
END

PUBLIC SUB Form_Open()
  FHilfe.ShowModal                                                        ' Dialog anzeigen
END

PUBLIC SUB Form_Close()
  ME.Close                                                                ' Dialog schließen und zurück zum Programm
END

PUBLIC SUB btnOK_Click()                                                  ' der Knopf "OK" wurde gedrückt
  Form_Close()                                                            ' Form_Close() zum Beenden aufrufen
END
